<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Web Monetization Providers · Web Monetization</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt; This page is a proposal for how browsers can implement Web Monetization. All"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Web Monetization Providers · Web Monetization"/><meta property="og:type" content="website"/><meta property="og:url" content="https://webmonetization.org/"/><meta property="og:description" content="&gt; This page is a proposal for how browsers can implement Web Monetization. All"/><meta property="og:image" content="https://webmonetization.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/fav-webmonetization.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/wm-icon.svg" alt="Web Monetization"/><h2 class="headerTitleWithLogo">Web Monetization</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/getting-started" target="_self">Docs</a></li><li class=""><a href="/specification.html" target="_self">Specification</a></li><li class=""><a href="https://discourse.wicg.io/t/proposal-web-monetization-a-new-revenue-model-for-the-web/3785" target="_self">WICG Forum</a></li><li class=""><a href="https://github.com/interledger/webmonetization.org" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Explainer</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/getting-started">Quick Start Guide</a></li><li class="navListItem"><a class="navItem" href="/docs/api">JavaScript API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Explainer</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/explainer">Web Monetization</a></li><li class="navListItem"><a class="navItem" href="/docs/receiving">Receiving Payments</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/sending">Sending Payments</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">More</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/specification">Specification</a></li><li class="navListItem"><a class="navItem" href="/docs/glossary">Glossary</a></li><li class="navListItem"><a class="navItem" href="/docs/resources">External Resources</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Web Monetization Providers</h1></header><article><div><span><blockquote>
<p>This page is a proposal for how browsers can implement Web Monetization. All
information is considered experimental and conversations are ongoing. If you
are a content creator you can skip this page.</p>
</blockquote>
<p>This page describes the functions of the Web Monetization provider and
how the provider could manifest as a payment handler. Web Monetization providers
are also known as Web Monetization senders.</p>
<p>A Web Monetization sender is a digital entity that makes payments on behalf of
a user and is capable of sending micropayments to Web Monetization receivers.</p>
<p>The Web Monetization sender interfaces with a browser so the Web Monetization
agent (e.g. extension) can send payment instructions, such as who to pay, when,
and how much.</p>
<h2><a class="anchor" aria-hidden="true" id="payment-handler-api"></a><a href="#payment-handler-api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Payment Handler API</h2>
<p>Our expectation is the Web Monetization (WM) sender will manifest as a payment
handler as follows.</p>
<p>The WM sender interface leverages the Payment Handler API. The API contains
capabilities that enable Web applications to handle requests for payments. You
can read the working draft of the spec on the
<a href="https://www.w3.org/TR/payment-handler/">W3C website</a>.</p>
<p>The Payment Handler API aligns well with the model anticipated for WM senders:
A WM sender could manifest as a specialized payment handler capable of returning
not just a <code>PaymentResponse</code> but also a handle to a stream of micropayments.</p>
<h3><a class="anchor" aria-hidden="true" id="monetization-payment-method"></a><a href="#monetization-payment-method" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>monetization</code> - Payment Method</h3>
<p>Payment handlers able to act as WM senders <strong>MUST</strong> register themselves with the
platform as supportive of the <code>monetization</code> payment method.</p>
<p>The <code>monetization</code> payment method identifier will be registered as a
<a href="https://www.w3.org/TR/payment-method-id/#standardized-payment-method-identifiers">standardized payment method</a>
through the Web Payments WG at W3C.</p>
<h3><a class="anchor" aria-hidden="true" id="paymentrequestevent-event"></a><a href="#paymentrequestevent-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>PaymentRequestEvent</code> - Event</h3>
<p>When the user's browser sends a payment via the WM sender, the browser emits a
<a href="https://www.w3.org/TR/payment-handler/#the-paymentrequestevent"><code>PaymentRequestEvent</code></a>.</p>
<p>The <code>PaymentRequestEvent</code> contains a single
<a href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary"><code>PaymentMethodData</code></a>
dictionary in the <code>PaymentRequestEvent.methodData</code> property.</p>
<p>The <code>PaymentMethodData</code> dictionary contains the value <code>monetization</code> in the
<code>supportedMethods</code> property. <code>data</code> is an instance of a
<a href="#monetizationrequest-dictionary"><code>MonetizationRequest</code></a> containing the
destination (WM receiver) address to send to, the condition, and expiry values
to use. The payment handler uses this data to send a single Interledger payment
to the destination address. The amount sent by the payment handler is the amount
specified in <code>PaymentRequestEvent.total</code>. <code>PaymentRequestEvent.total</code> is an
instance of <a href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary"><code>PaymentCurrencyAmount</code></a>
specifying both an amount (<code>value</code>) and a <code>currency</code>.</p>
<pre><code class="hljs css language-webidl"><span class="hljs-keyword">dictionary </span>PaymentCurrencyAmount {
  required DOMString currency<span class="hljs-comment">;</span>
  required DOMstring value<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>The payment handler then invokes <code>PaymentRequestEvent.respondWith()</code>:</p>
<pre><code class="hljs css language-ts">paymentRequestEvent.respondWith(
    <span class="hljs-comment">// Promise that resolves with a PaymentResponse.</span>
  )
</code></pre>
<p>And responds with either a pass or a fail:</p>
<ul>
<li>Pass - passes in a <code>Promise</code> that resolves to an instance of
<a href="#monetizationresponse-dictionary"><code>MonetizationResponse</code></a> containing the
fulfillment and data from the response.</li>
</ul>
<blockquote>
<p><a href="https://github.com/interledger/webmonetization.org/issues/15">Issue 15 - Should Web Monetization senders know origin of the monetized website?</a><p>The <code>PaymentRequestEvent</code> currently includes the origin of the calling website. Should this be removed for monetization to preserve the user's privacy?</p>
</blockquote>
<ul>
<li>Fail - provides a rejected <code>Promise</code> indicating that the payment failed
because the handler was unable to send in the specified currency.</li>
</ul>
<blockquote>
<p><a href="https://github.com/interledger/webmonetization.org/issues/18">Issue 18 - Indicate Failure Reasons from Web Monetization Sender</a></p>
</blockquote>
<p>For more information about the JavaScript <code>Promise</code> object, see the
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">MDN Web docs</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="monetizationrequest-dictionary"></a><a href="#monetizationrequest-dictionary" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>MonetizationRequest</code> - Dictionary</h3>
<p>The data in the <code>MonetizationRequest</code> emitted to the payment handler contains
the destination (WM receiver) address for the payment, the condition, expiry,
and data to use in the Interledger packet.</p>
<pre><code class="hljs css language-webidl">  <span class="hljs-keyword">dictionary </span>MonetizationRequest {
    required DOMString destination<span class="hljs-comment">;</span>
    required DOMString condition<span class="hljs-comment">;</span>
    required DOMString expiry<span class="hljs-comment">;</span>
    DOMString data<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
</code></pre>
<table>
<thead>
<tr><th>Property</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>destination</td><td>The ILP address of the WM receiver for this session.</td></tr>
<tr><td>condition</td><td>32 bytes, base64-encoded condition to use for the ILP packet. The WM receiver must be able to fulfill this condition.</td></tr>
<tr><td>expiry</td><td>Expiration date and time for when the ILP packet expires.</td></tr>
<tr><td>data</td><td>Base64-encoded additional data to send in the ILP packet.</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="monetizationresponse-dictionary"></a><a href="#monetizationresponse-dictionary" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>MonetizationResponse</code> - Dictionary</h3>
<p>The data in the <code>MonetizationResponse</code> that is sent by the payment handler
contains the fulfillment from the successful payment and the data from the
fulfill packet.</p>
<pre><code class="hljs css language-webidl">  <span class="hljs-keyword">dictionary </span>MonetizationRequest {
    required DOMString fulfillment<span class="hljs-comment">;</span>
    DOMString data<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
</code></pre>
<table>
<thead>
<tr><th>Property</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>fulfillment</td><td>32 bytes, base64-encoded fulfillment from the ILP packet (returned by the payee).</td></tr>
<tr><td>data</td><td>Base64-encoded additional data received from the ILP packet.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="open-authorization-issues"></a><a href="#open-authorization-issues" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Open Authorization Issues</h2>
<p>When the payment handler is invoked (handling a new <code>PaymentRequestEvent</code>) it's
expected to send a payment on behalf of the user.</p>
<p>If the payment handler is not authorized to send payments it can either:</p>
<ul>
<li>Invoke <code>PaymentRequestEvent.openWindow()</code> to provide a UI to the user to log
in and authorize the payment</li>
<li>Reject the request by passing a rejected <code>Promise</code> to
<code>PaymentRequestEvent.respondWith()</code> and let the browser handle the case</li>
</ul>
<p><em>Invoke</em> is quite intrusive on the user experience unless it's throttled by the
browser in some way. <em>Reject</em> is likely to result in a lot of failures that go
undetected.</p>
<h2><a class="anchor" aria-hidden="true" id="supporting-payment-streams"></a><a href="#supporting-payment-streams" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Supporting Payment Streams</h2>
<p>As detailed in the <a href="/docs/explainer">explainer</a>, the user's browser receives a
unique destination address and shared secret for each monetization session (e.g.
page refresh, navigation). This specification assumes that the browser will
handle the generation of a new condition using the shared secret for each
payment it wants to send.</p>
<p>Note that the browser will then emit multiple <code>PaymentRequestEvent</code> events (one
for each payment). This is in contrast to how the event is expected to be
emitted. The expectation is that a website creates a single <code>PaymentRequest</code>
event. The single event is emitted as a result of the website calling <code>show()</code>
and the user selecting a payment instrument. In this case (with a single
event), the calling website waits for the <code>Promise</code> returned by <code>show()</code>,
then resolves the value passed by the payment handler to <code>respondWith()</code>.</p>
<p>While this proposal requires minimal changes to the Payment Handler API
specification it does imply some changes to the
<a href="https://www.w3.org/TR/payment-handler/#handling-a-payment-request">Handling a Payment Request</a>
and <a href="https://www.w3.org/TR/payment-handler/#dfn-methoddata-population-algorithm">MethodData Population</a>
algorithms.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/receiving"><span class="arrow-prev">← </span><span>Receiving Payments</span></a><a class="docs-next button" href="/docs/specification"><span>Specification</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#payment-handler-api">Payment Handler API</a><ul class="toc-headings"><li><a href="#monetization-payment-method"><code>monetization</code> - Payment Method</a></li><li><a href="#paymentrequestevent-event"><code>PaymentRequestEvent</code> - Event</a></li><li><a href="#monetizationrequest-dictionary"><code>MonetizationRequest</code> - Dictionary</a></li><li><a href="#monetizationresponse-dictionary"><code>MonetizationResponse</code> - Dictionary</a></li></ul></li><li><a href="#open-authorization-issues">Open Authorization Issues</a></li><li><a href="#supporting-payment-streams">Supporting Payment Streams</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>WebMonetization.org</h5></div><div><h5>Navigation</h5><a href="/">Home</a><a href="/meta-tag">Meta Tag Generator</a></div><div><h5>Community</h5><a href="https://github.com/interledger/webmonetization.org" target="_blank" rel="noreferrer noopener">GitHub</a><a href="https://forum.interledger.org" target="_blank" rel="noreferrer noopener">ILP Forum</a><a href="https://discourse.wicg.io/t/proposal-web-monetization-a-new-revenue-model-for-the-web/3785" target="_blank" rel="noreferrer noopener">Web Platform Incubator Community Group</a><a href="https://interledger.org" target="_blank" rel="noreferrer noopener">Interledger</a></div><div><h5>Resources</h5><a href="/docs/getting-started.html">Docs</a><a href="/specification.html" target="_blank" rel="noreferrer noopener">Specification</a><a href="https://paymentpointers.org" target="_blank" rel="noreferrer noopener">Payment Pointers</a></div></section><section class="copyright"></section></footer></div></body></html>